<main class="auth-shell">
  <div class="auth-shell__bg-pattern" aria-hidden="true"></div>
  <%= image_tag "/auth/auth-character-left.png", class: "auth-shell__character auth-shell__character--left", alt: "", aria: { hidden: true } %>
  <%= image_tag "/auth/auth-character-right.png", class: "auth-shell__character auth-shell__character--right", alt: "", aria: { hidden: true } %>
  <%= image_tag "/auth/auth-character-bottom.png", class: "auth-shell__character auth-shell__character--bottom", alt: "", aria: { hidden: true } %>
  <%= image_tag "/auth/auth-paper-plane.svg", class: "auth-shell__plane", alt: "", aria: { hidden: true } %>

  <header class="auth-shell__header">
    <a href="/" class="auth-shell__brand" aria-label="Home">
      <%= image_tag "/auth/auth-logo-mark.png", class: "auth-shell__brand-mark", alt: "", aria: { hidden: true } %>
    </a>

    <nav class="auth-shell__top-nav" aria-label="Authentication links">
      <%= render "shared/ig_button", label: "Just Write", variant: "subtle", type: "button", class_name: "auth-shell__request-demo" %>
    </nav>
  </header>

  <section class="auth-shell__center">
    <div class="auth-shell__card">
      <h1 class="auth-shell__title"><%= local_assigns[:auth_title] %></h1>
      <p class="auth-shell__subtitle <%= "auth-shell__subtitle--empty" if local_assigns[:auth_subtitle].blank? %>">
        <%= local_assigns[:auth_subtitle] %>
      </p>

      <% form_method = local_assigns[:form_method].presence || "post" %>
      <% form_http_method = form_method.to_s.downcase %>
      <% form_action = local_assigns[:form_action].presence || "#" %>

      <% if flash[:alert].present? %>
        <p class="auth-shell__flash auth-shell__flash--alert"><%= flash[:alert] %></p>
      <% elsif flash[:notice].present? %>
        <p class="auth-shell__flash auth-shell__flash--notice"><%= flash[:notice] %></p>
      <% end %>

      <% if local_assigns[:resource].present? && local_assigns[:resource].errors.any? %>
        <div class="auth-shell__errors" role="alert" aria-live="polite">
          <% local_assigns[:resource].errors.full_messages.each do |message| %>
            <p><%= message %></p>
          <% end %>
        </div>
      <% end %>

      <form class="auth-shell__form" action="<%= form_action %>" method="<%= form_http_method == "get" ? "get" : "post" %>">
        <% unless form_http_method == "get" %>
          <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>">
        <% end %>
        <% if !%w[get post].include?(form_http_method) %>
          <input type="hidden" name="_method" value="<%= form_http_method %>">
        <% end %>

        <% local_assigns.fetch(:auth_fields, []).each do |field| %>
          <%= render "shared/ig_input",
            label: field[:label],
            type: field[:type],
            name: field[:name],
            placeholder: field[:placeholder],
            value: field[:value],
            autocomplete: field[:autocomplete],
            width: "100%" %>
        <% end %>

        <% if local_assigns[:show_marketing_opt_in] %>
          <% checkbox_label = local_assigns[:marketing_opt_in_label].presence || "Send me onboarding and product updates." %>
          <% checkbox_name = local_assigns[:marketing_opt_in_name].presence || "marketing_opt_in" %>
          <%= render "shared/ig_checkbox",
            label: checkbox_label,
            name: checkbox_name,
            class_name: "auth-shell__checkbox" %>
        <% end %>

        <% if local_assigns[:legal_copy_html].present? %>
          <p class="auth-shell__legal"><%= local_assigns[:legal_copy_html].html_safe %></p>
        <% elsif local_assigns[:legal_copy].present? %>
          <p class="auth-shell__legal"><%= local_assigns[:legal_copy] %></p>
        <% end %>

        <div class="auth-shell__actions">
          <%= render "shared/ig_button",
            label: local_assigns[:secondary_cta_label],
            variant: "subtle",
            type: "button",
            width: "7.25rem",
            class_name: "auth-shell__secondary-button" %>
          <%= render "shared/ig_button",
            label: local_assigns[:primary_cta_label],
            type: "submit",
            width: "12rem",
            class_name: "auth-shell__primary-button" %>
        </div>
      </form>
    </div>
  </section>

  <footer class="auth-shell__footer">
    <p>"Only fear can defeat life"</p>
  </footer>
</main>
